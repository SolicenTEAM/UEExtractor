# Solicen.UEExtractor

[**English**](/README.md) | [**Русский**](./docs/ru/README.ru.md)

Сделано с ❤️ для **всех** переводчиков и разработчиков переводов.

Это скрипт на **.NET 8.0** для извлечения текста из любой игры на [Unreal Enigne](https://www.unrealengine.com/) (4.0 - 5.1).<br>Используется [CUE4Parse](https://github.com/FabianFG/CUE4Parse) для работы с Unreal Engine архивами **`.pak`** и **`.utoc`** 

С его помощью вы получите файл `locresCSV` для локализации игры на основе ее ресурсов. Однако `locresCSV` не является специальным форматом, и это название используется только для отделения от обычного файла CSV, которым он и является.

> [!CAUTION]
> Вы не сможете получить строки из файлов, что содержат **DataTable** структуру и оперировать этими строками через `.locres`.
> - Не открывайте *запрос* на решение этой проблемы, я не смогу её решить. 
> - Это не моя вина, спасибо за понимание. 

# Структура LocresCSV:
Может быть импортирована или преобразована в файл `.locres`.
- key = хэш (строка из 32 символов) 
- source = расшифрованная строка
- Translation = (Null из распакованных ресурсов)
```
key,source,Translation
4A6FDB1549E45F6C5D8D739129686E2F,Default,
```
*Импорт колонки **Translation** из CSV в `.locres` возможен через [UE4localizationsTool](https://github.com/amrshaheen61/UE4LocalizationsTool).*

## Подготовка:
### Для игр использующих Unreal Engine 4 до [ZenLoader](https://dev.epicgames.com/documentation/en-us/unreal-engine/zen-loader-in-unreal-engine).
Узнайте, необходим ли вашей игре **AES ключ** или нет, он может быть и не нужен, и эти шаги можно пропустить.
> [!TIP]
> Не обязательно, но **вы можете указать Unreal Engine версию** `-v=UE5_1` что используется в вашей игре.
> - Она будет найдена автоматически, но приоритет отдается аргументу, если вы этого хотите.
> - Все определения **UE версии** исходят из CUE4Parse, вы можете узнать какая версия вам нужна через FModel.

1. Вам нужен **AES ключ** для просмотра архивов и получения данных из него. 
   - Вы можете найти его в интернете, если у вас его нет, или *найти* в ресурсах игры.
2. Положите `aes.txt` файл в главную папку игры, что содержит одну строку с символами ключа.
   - Или укажите его через аргумент `--aes=<key>`. Ключ всегда должен начинаться на `0x`.

###  Для игр использующих Unreal Engine 4-5 с [ZenLoader](https://dev.epicgames.com/documentation/en-us/unreal-engine/zen-loader-in-unreal-engine).
Для начала, проделайте шаги описанные выше, и только после продолжайте.
> [!IMPORTANT]
> Вам нужно получить `.usmap` файл для доступа к игровым архивам и ресурсам. 
> - Как и раньше, вы можете найти этот файл в интернете, если у вас его ещё нет.
> - Посмотрите на [nexusmods](https://www.nexusmods.com/) и форумах посвященных модам, на его наличие, Уверен, вы найдете его.

1. Положите `.usmap` файл в главную папку игры (или любую подпапку), и он будет найден автоматически. 
2. Подготовка к работе завершена.


## Использование:
* Или [загрузите](https://github.com/SolicenTEAM/UEExtractor/releases) и **перетащите папку** на `UEExtractor.exe`, чтобы проанализировать каталог и получить `<имя>.csv`.
* Или используйте `UEExtractor.exe` в командной строке для полного анализа каталога.

### UEExtractor - Unreal Engine (текстовый) извлекатор
- **Перетащите папку** с ресурами игры на `UEExtractor.exe`, чтобы проанализировать каталог и получить `<имя>.csv`. 
- **Перетащите `locresCSV`** на `UEExtractor.exe`, чтобы получить `.locres` файл в каталоге с программой.
- Или воспользуйтесь более расширенными параметрами через терминал.

#### Извлечь *locresCSV* из игры:
```cmd
UEExtractor.exe <путь до каталога> <имя csv> --аргумент1 --аргумент2
```

#### Собрать *.locres* из csv файла:
```cmd
UEExtractor.exe <csv файл> <путь до locres> 
```


| Аргумент | Описание |
|----------|-------------|
| -v=UE5.1, --version=Stalker2 | указывает особую версию Unreal Engine.
| -a=[key], --aes=[key] | 32-символьная HEX строка как AES ключ.
| --skip-uexp, --skip-uasset | пропускает файлы `.uexp` или `.uasset` во время процесса.
| --locres | сразу записывает `.locres` файл после анализа каталога.
| --underscore | не пропускать строки с подчеркиванием: **ex_string**
| --upper-upper | не пропускать строки с только БОЛЬШИМИ символами: **ПРИМЕР**
| --no-parallel | отключить параллельную обработку, медленнее, может выдать дополнительные данные.
| --table-format | меняет символ разделителя **`,`** на **`\|`**
| --headmark | включить заголовок и футер в файл `.csv`
| --autoexit | автоматически закрыть после завершения всех процессов.
| --invalid | включить невалидные данные в вывод.
| --qmarks | принудительно добавляет кавычки между текстовыми строками.
| --hash | включить хеш строки для локреса, пример: [key][hash],[string]
| --url | включить путь до файл для локреса, пример: [url][key],[string]
| --picky | строгий режим, отображает больше надоедливой информации.
| --help | отображает справочную информацию.


## Ваш вклад:
* Вы можете создать свой собственный форк этого проекта и внести свой вклад в его развитие.
* Вы также можете внести свой вклад через вкладки [Issues](https://github.com/SolicenTEAM/UEExtractor/issues) и [Pull Request](https://github.com/SolicenTEAM/UEExtractor/pulls), предложив свои изменения кода.<br>И дальнейшее развитие проекта. 

## Спасибо:
- [Ambi](https://github.com/JunkBeat) за код и идею для исследования. 
- [Saipan](https://github.com/Saipan0) за помощь в ислледованиях в создании locres файла.
- [FabianFG](https://github.com/FabianFG) за **CUE4Parse** библиотеку и FModel.